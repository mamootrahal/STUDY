import pandas as pd
import numpy as np
import sys
from io import StringIO

#loc -- по меткам индекса
# iloc -- по индексам (0, 1, 2, 3, ...)

# Упражнения 6–10 (фильтры и новые столбцы)

# Добавь столбец Балл_на_год = Балл / Возраст (float).

# Отсортируй по Балл по убыванию, а при равенстве — по Возраст по возрастанию.

# Упражнения 11–15 (groupby + агрегации)

# Посчитай, сколько раз встречается каждое имя (как в задаче “самое частое имя”).

# Найди имя(имена) с максимальной частотой, выведи в алфавитном порядке.

# Посчитай средний балл по городам.

# Для каждого города посчитай: count, mean, max по столбцу Балл.

# Для каждого имени посчитай: средний возраст и сумму баллов (через .agg с именованными агрегатами).

# Упражнения 16–18 (merge/concat — прям база)

# Сделай таблицу “надбавки” и склей с df по имени:

# bonus = pd.DataFrame({
#     "Имя":["Иван","Анна","Петр"],
#     "Бонус":[100, 200, 50]
# })


# Сделай left merge, чтобы у всех остались строки, а у кого нет бонуса — будет NaN.

# Заполни NaN в Бонус нулём.

# Сделай новый DataFrame из первых 4 строк и последних 4 строк и склей их concat по строкам (axis=0).

# Упражнение 19–20 (чистка данных)

# Переименуй столбец Балл в Score.

# Удали столбец Балл_на_год (если делал), и удали дубликаты по паре (Имя, Возраст) если они вдруг есть.

df = pd.DataFrame({
    "brand": ["A","A","B","B","B","C"],
    "color": ["red","red","blue","blue","green","red"],
    "price": [10, 12, 8, 8, 9, 11]
})

print("\n", df,'_'*30, "\n")

g = df.groupby("brand")
print(pd.DataFrame(g["color"].size()))